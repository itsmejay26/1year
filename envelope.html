<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Interactive Envelope</title>
  <link href="https://fonts.googleapis.com/css2?family=Shadows+Into+Light&display=swap" rel="stylesheet">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      min-height: 100vh;
      background: linear-gradient(135deg, #ffc0cb, #dda0dd);
      display: flex;
      justify-content: center;
      align-items: center;
      font-family: 'Shadows Into Light', cursive;
      overflow: hidden;
    }

  .fade-out-all *:not(body):not(.sparkle) {
  opacity: 0 !important;
  transition: opacity 1s ease;
  pointer-events: none;
}
  
    .envelope-container {
      position: relative;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .envelope {
      position: relative;
      width: 300px;
      height: 195px;
      cursor: pointer;
      transform-style: preserve-3d;
      animation: float 3s ease-in-out infinite;
    }

    @keyframes float {
      0%, 100% { transform: translateY(0px) rotate(0deg); }
      50% { transform: translateY(-20px) rotate(2deg); }
    }

    .back, .left, .right, .bottom {
      position: absolute;
      width: 100%;
      height: 100%;
      transition: all 0.6s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .back { background: #f26c91; clip-path: polygon(0 0, 100% 0, 50% 50%); z-index: 0; }
    .left { clip-path: polygon(0 0, 50% 50%, 0 100%); background: #ff94b3; z-index: 2; }
    .right { clip-path: polygon(100% 0, 100% 100%, 50% 50%); background: #ff94b3; z-index: 3; }
    .bottom { clip-path: polygon(0 100%, 50% 50%, 100% 100%); background: #f78da7; z-index: 4; }

    .flap {
      position: absolute;
      width: 100%;
      height: 200%;
      background: #f26c91;
      clip-path: polygon(50% 50%, 0 0, 100% 0);
      transform-origin: top center;
      z-index: 1;
      transition: transform 1.2s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .envelope.opening .flap { transform: rotateX(-120deg); }

    .letter {
      position: absolute;
      top: 30px;
      left: 15px;
      width: 270px;
      height: 150px;
      background: white;
      border-radius: 8px;
      box-shadow: 0 5px 20px rgba(0,0,0,0.2);
      z-index: 0;
      transform: scaleY(0);
      transform-origin: bottom center;
      transition: transform 1.2s cubic-bezier(0.4, 0, 0.2, 1);
      opacity: 0;
    }

    .envelope.opening .letter {
      transform: scaleY(1.2);
      opacity: 1;
    }

    .envelope.closing .letter {
      transform: scaleY(0);
      opacity: 0;
      transition: transform 2.0s, opacity 0.8s;
    }

    .envelope.closing .flap {
      transform: rotateX(0deg);
      transition: transform 2.0s;
    }

    .message-modal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.5);
      display: flex;
      justify-content: center;
      align-items: center;
      opacity: 0;
      visibility: hidden;
      transition: all 0.3s ease;
      z-index: 1000;
    }

    .message-modal.active { opacity: 1; visibility: visible; }

    .message-content {
      background: white;
      width: 600px;
      height: 400px;
      border-radius: 15px;
      position: relative;
      box-shadow: 0 20px 60px rgba(0,0,0,0.3);
      transform: scale(0.8);
      transition: transform 0.3s ease;
      font-family: 'Shadows Into Light', cursive;
    }

    .message-modal.active .message-content { transform: scale(1); }

    .close-btn {
      position: absolute;
      top: 15px;
      right: 20px;
      background: #ff6b9d;
      color: white;
      border: none;
      width: 40px;
      height: 40px;
      border-radius: 50%;
      font-size: 20px;
      cursor: pointer;
      transition: all 0.3s ease;
      z-index: 10;
    }

    .close-btn:hover {
      background: #e91e63;
      transform: scale(1.1);
    }

    .message-page {
      padding: 60px 40px 80px;
      height: 100%;
      display: none;
      overflow-y: auto;
      text-align: center;
    }

    .message-page.active { display: block; }

    .message-page h2 { display: none; }

    .message-page p {
      color: #444;
      font-size: 18px;
      margin: auto;
      padding-top: 80px;
      line-height: 1;
    }

    .navigation {
  margin-top: 20px;
  display: flex;
  justify-content: center;
  gap: 20px;
  position: relative;
  bottom: unset;
  left: unset;
  transform: unset;
}

    .nav-btn {
      background: linear-gradient(135deg, #ff6b9d, #e91e63);
      color: white;
      border: none;
      padding: 12px 24px;
      border-radius: 25px;
      cursor: pointer;
      font-weight: bold;
      transition: all 0.3s ease;
      box-shadow: 0 5px 15px rgba(255, 107, 157, 0.3);
    }

    .nav-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 25px rgba(255, 107, 157, 0.4);
    }

    .nav-btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }

    .sparkle {
      position: absolute;
      color: #ff6b9d;
      font-size: 20px;
      animation: sparkle 2s infinite;
      pointer-events: none;
    }

    @keyframes sparkle {
      0%, 100% { opacity: 0; transform: scale(0); }
      50% { opacity: 1; transform: scale(1); }
    }

    .heart {
      color: #ff6b9d;
      display: inline-block;
      animation: heartbeat 1.5s ease-in-out infinite;
    }

    @keyframes heartbeat {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.1); }
    }
  </style>
</head>
<body>
  <div class="envelope-container">
    <div class="envelope" id="envelope">
      <div class="back"></div>
      <div class="left"></div>
      <div class="right"></div>
      <div class="bottom"></div>
      <div class="flap"></div>
      <div class="letter"></div>
    </div>
  </div>

  <!-- Sparkles -->
  <div class="sparkle" style="top: 20%; left: 10%;">‚ú®</div>
  <div class="sparkle" style="top: 30%; right: 15%; animation-delay: 0.5s;">üí´</div>
  <div class="sparkle" style="bottom: 25%; left: 20%; animation-delay: 1s;">‚≠ê</div>
  <div class="sparkle" style="top: 60%; right: 25%; animation-delay: 1.5s;">‚ú®</div>

  <div class="message-modal" id="messageModal">
    <div class="message-content">
      <button class="close-btn" id="closeBtn">√ó</button>

      <div class="message-page active" id="page1">
        <p>message1</p>
      </div>

      <div class="message-page" id="page2">
        <p>message2</p>
      </div>

      <div class="message-page" id="page3">
        <p>message3</p>
      </div>

      <div class="message-page" id="page4">
        <p>message4</p>
      </div>

      <div class="navigation">
  <button class="nav-btn" id="prevBtn" disabled>Back</button>
  <button class="nav-btn" id="nextBtn">Next</button>
</div>
    </div>
  </div>

  <script>
  let currentPage = 1;
  const totalPages = 4;

  const envelope = document.getElementById('envelope');
  const messageModal = document.getElementById('messageModal');
  const closeBtn = document.getElementById('closeBtn');
  const prevBtn = document.getElementById('prevBtn');
  const nextBtn = document.getElementById('nextBtn');

  envelope.addEventListener('click', () => {
    envelope.classList.add('opening');
    setTimeout(() => {
      messageModal.classList.add('active');
    }, 1200);
  });

  closeBtn.addEventListener('click', closeModal);
  messageModal.addEventListener('click', (e) => {
    if (e.target === messageModal) closeModal();
  });

  function closeModal() {
    messageModal.classList.remove('active');
    envelope.classList.add('closing');
    envelope.classList.remove('opening');
    setTimeout(() => {
      envelope.classList.remove('closing');
      currentPage = 1;
      showPage(currentPage);
    }, 1000);
  }

  prevBtn.addEventListener('click', () => {
    if (currentPage > 1) {
      currentPage--;
      showPage(currentPage);
    }
  });

  nextBtn.addEventListener('click', () => {
    if (currentPage < totalPages) {
      currentPage++;
      showPage(currentPage);
    } else {
  // fade out everything except background
  document.body.classList.add('fade-out-all');
  setTimeout(() => {
    window.location.href = 'almost.html';
  }, 1200); // wait for fade animation
}
  });

  function showPage(pageNum) {
    document.querySelectorAll('.message-page').forEach(page => page.classList.remove('active'));
    document.getElementById(`page${pageNum}`).classList.add('active');

    prevBtn.disabled = pageNum === 1;
    
    // change button text based on current page
    if (pageNum === totalPages) {
      nextBtn.textContent = 'Done';
    } else {
      nextBtn.textContent = 'Next';
    }
  }

  document.addEventListener('keydown', (e) => {
    if (messageModal.classList.contains('active')) {
      if (e.key === 'ArrowLeft' && currentPage > 1) {
        currentPage--;
        showPage(currentPage);
      } else if (e.key === 'ArrowRight' && currentPage < totalPages) {
        currentPage++;
        showPage(currentPage);
      } else if (e.key === 'ArrowRight' && currentPage === totalPages) {
        window.location.href = 'almost.html';
      } else if (e.key === 'Escape') {
        closeModal();
      }
    }
  });

  showPage(currentPage);
</script>
</body>
  </html>
